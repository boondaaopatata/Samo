<!DOCTYPE html>
<html>
  <head>
    <title>Tic Tac Toe</title>
    <style>
      body{
        background-color:rgb(64, 63, 63);
        color:white;
      }
      .start-game{
        margin-top: 150px;
        margin-left:300px;
        font-size:100px;
      }
      .m1{
        margin-left:420px;
        padding:20px;
        font-size:30px;
        border:none;
        border-radius:20px;
      }
      .m2 ,.m3{
        padding:20px;
        font-size:30px;
        margin-left:10px;
        border:none;
        border-radius:20px;
      }
      .grid 
      {
        display: grid;
        grid-template-columns: repeat(3, 100px);
        grid-gap: 15px;
        justify-content:center;
        margin-top:-130px;
      }
      .ox-button 
      {
        width: 100px;
        height: 100px;
        font-size: 100px;
        text-align:center;
        line-height: 100px;
      }
      .result{
        font-size: 40px;
        text-align:center;
      }
      .reset-button{
        margin-left:475px;
        padding:20px;
        font-size:20px;
        border:none;
        border-radius:20px;
      }
      .play-again-button{
        padding:20px;
        font-size:20px;
        border:none;
        border-radius:20px;
        margin-left:10px;
      }
      .main-menu{
        padding:20px;
        font-size:20px;
        margin-left:555px;
        margin-top:30px;
        border:none;
        border-radius:20px;
      }
    </style>
  </head>
  <body>
    <p class="start-game">START GAME</p>
    <p class="game-here"></p>
    <div class="m-buton">
      <button class="mode-button m1" onclick="startGame();mode=1;">Easy</button>
      <button class="mode-button m2" onclick="startGame();mode=2;">Medium</button>
      <button class="mode-button m3" onclick="startGame();mode=3;">Hard</button>
    </div>
      
    
    <script>
      let mode;
      let score=JSON.parse(localStorage.getItem('score'))||
        {
        Wins:0,
        Losses:0,
        Ties:0
        }
        let count;
      function startGame()
      {
        document.querySelectorAll('.mode-button').forEach(btn => btn.remove());
        document.querySelector('.start-game').innerHTML='';
        document.querySelector('.game-here').innerHTML=`<div class="grid">
        <button class="a ox-button" onclick="game('a');"></button>
        <button class="b ox-button" onclick="game('b');"></button>
        <button class="c ox-button" onclick="game('c');"></button>
        <button class="d ox-button" onclick="game('d');"></button>
        <button class="e ox-button" onclick="game('e');"></button>
        <button class="f ox-button" onclick="game('f');"></button>
        <button class="g ox-button" onclick="game('g');"></button>
        <button class="h ox-button" onclick="game('h');"></button>
        <button class="i ox-button" onclick="game('i');"></button>
        </div>
        <p class="displayResult result"></p>
        <p class="Winner result"></p>
        <div>
        <button class="reset-button" onclick="resetScore();">Reset Score</button>
        <button class="play-again-button" onclick="playAgain();">Play Again</button>
        </div>
        <a href='tic-tactoe.html'><button class="main-menu">Main Menu</button></a>`;


        document.querySelector('.displayResult').innerHTML=`Wins: ${score.Wins}, Losses: ${score.Losses}, Ties: ${score.Ties}`;
      }
      function game(buttonLetter)
      {
        let userSelectedButton=document.querySelector(`.${buttonLetter}`);
        
        if(userSelectedButton.innerHTML===`x` || userSelectedButton.innerHTML===`o`)
          return;
        else
          userSelectedButton.innerHTML=`x`

        let endGame=CheckWinner();
        if(endGame===1)
        {
          document.querySelector('.displayResult').innerHTML=`Wins: ${score.Wins}, Losses: ${score.Losses}, Ties: ${score.Ties}`;
          return;
        }
        const FreeButtons=Array.from(document.querySelectorAll('button')).filter(button => button.innerHTML==='');

        if(FreeButtons.length===0)
        {
          document.querySelector('.Winner').innerHTML='You Drew';
          score.Ties++;
          document.querySelector('.displayResult').innerHTML=`Wins: ${score.Wins}, Losses: ${score.Losses}, Ties: ${score.Ties}`;
          return;
        }
        let i=0;
        let Pick=[];
        let BestPick;
        let choice=['a','b','c','d','e','f','g','h','i'];
        shuffleArray(choice); 
        while(i<9)
        {
          if(document.querySelector(`.${choice[i]}`).innerHTML==='')
          {
            Pick.push(choice[i]);
          }
          i++;
        }
        BestPick=CheckForBestPick(Pick);
        console.log(BestPick);
        document.querySelector(`.${BestPick}`).innerHTML=`o`;
        
        endGame=CheckWinner();
        if(endGame===1)
        {
          document.querySelector('.displayResult').innerHTML=`Wins: ${score.Wins}, Losses: ${score.Losses}, Ties: ${score.Ties}`;
          return;
        }

        localStorage.setItem('score',JSON.stringify(score));
      }
      function CP(Pick){
        switch(Pick)
        {
          case 1:
          return'a';
          break;
          case 2:
          return'b';
          break;
          case 3:
          return'c';
          break;
          case 4:
          return'd';
          break;
          case 5:
          return'e';
          break;
          case 6:
          return'f';
          break;
          case 7:
          return'g';
          break;
          case 8:
          return'h';
          break;
          case 9:
          return'i';
          break;
          default:
          return null;
        }
      }
      function CheckWinner()
      { 
        
        let button_A = document.querySelector('.a');
        let button_B = document.querySelector('.b');
        let button_C = document.querySelector('.c');
        let button_D = document.querySelector('.d');
        let button_E = document.querySelector('.e');
        let button_F = document.querySelector('.f');
        let button_G = document.querySelector('.g');
        let button_H = document.querySelector('.h');
        let button_I = document.querySelector('.i');
        if((
          button_A.innerHTML===`x`&&button_B.innerHTML===`x`&&button_C.innerHTML===`x`)
        ||(button_D.innerHTML===`x`&&button_E.innerHTML===`x`&&button_F.innerHTML===`x`)
        ||(button_G.innerHTML===`x`&&button_H.innerHTML===`x`&&button_I.innerHTML===`x`)
        ||(button_A.innerHTML===`x`&&button_D.innerHTML===`x`&&button_G.innerHTML===`x`)
        ||(button_B.innerHTML===`x`&&button_E.innerHTML===`x`&&button_H.innerHTML===`x`)
        ||(button_C.innerHTML===`x`&&button_F.innerHTML===`x`&&button_I.innerHTML===`x`)
        ||(button_A.innerHTML===`x`&&button_E.innerHTML===`x`&&button_I.innerHTML===`x`)
        ||(button_C.innerHTML===`x`&&button_E.innerHTML===`x`&&button_G.innerHTML===`x`))
        {
          document.querySelector('.Winner').innerHTML='You Won';
          score.Wins++;
          
          return 1;
        }
        else if ((
          button_A.innerHTML === `o` && button_B.innerHTML === `o` && button_C.innerHTML === `o`)
        ||(button_D.innerHTML === `o` && button_E.innerHTML === `o` && button_F.innerHTML === `o`)
        ||(button_G.innerHTML === `o` && button_H.innerHTML === `o` && button_I.innerHTML === `o`)
        ||(button_A.innerHTML === `o` && button_D.innerHTML === `o` && button_G.innerHTML === `o`)
        ||(button_B.innerHTML === `o` && button_E.innerHTML === `o` && button_H.innerHTML === `o`)
        ||(button_C.innerHTML === `o` && button_F.innerHTML === `o` && button_I.innerHTML === `o`)
        ||(button_A.innerHTML === `o` && button_E.innerHTML === `o` && button_I.innerHTML === `o`)
        ||(button_C.innerHTML === `o` && button_E.innerHTML === `o` && button_G.innerHTML === `o`))
        {
          document.querySelector('.Winner').innerHTML = 'The Computer Won';
          score.Losses++;
          return 1;
        }
        else
          return 0;
      }
      function shuffleArray(array) 
      {
        for (let i = array.length - 1; i > 0; i--) 
        {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }
      function resetScore()
      {
        score.Wins=0;
        score.Losses=0;
        score.Ties=0;
        localStorage.removeItem('score');
        document.querySelector('.displayResult').innerHTML=`Wins: ${score.Wins}, Losses: ${score.Losses}, Ties: ${score.Ties}`;
      }
      function playAgain()
      {
        let button_A = document.querySelector('.a');
        let button_B = document.querySelector('.b');
        let button_C = document.querySelector('.c');
        let button_D = document.querySelector('.d');
        let button_E = document.querySelector('.e');
        let button_F = document.querySelector('.f');
        let button_G = document.querySelector('.g');
        let button_H = document.querySelector('.h');
        let button_I = document.querySelector('.i');
        button_A.innerHTML='';
        button_B.innerHTML='';
        button_C.innerHTML='';
        button_D.innerHTML='';
        button_E.innerHTML='';
        button_F.innerHTML='';
        button_G.innerHTML='';
        button_H.innerHTML='';
        button_I.innerHTML='';
        document.querySelector('.Winner').innerHTML='';
      }
      function CheckForBestPick(Pick)
      {
        let bestPick;
        if(mode===1)
        {
          bestPick=easyMode(Pick);
        }
        else if(mode===2)
        {
          bestPick=mediumMode(Pick);
        }
        else if(mode===3)
        {
          bestPick=mediumMode(Pick);
        }
        return bestPick;
      }
      function easyMode(Pick)
      {
        return Pick[0];
      }
      function mediumMode(Pick)
      {
        let button_A = document.querySelector('.a');
        let button_B = document.querySelector('.b');
        let button_C = document.querySelector('.c');
        let button_D = document.querySelector('.d');
        let button_E = document.querySelector('.e');
        let button_F = document.querySelector('.f');
        let button_G = document.querySelector('.g');
        let button_H = document.querySelector('.h');
        let button_I = document.querySelector('.i');
        console.log(Pick);
        for(let i=0;i<Pick.length;i++)
        {
          if(Pick[i]==='g'
          &&((button_A.innerHTML === `o` && button_D.innerHTML === `o`)
          ||(button_H.innerHTML === `o` && button_I.innerHTML === `o`)
          ||(button_E.innerHTML === `o` && button_C.innerHTML === `o`)))
          {
            return 'g';
          }
          else if(Pick[i]==='h'
          &&((button_B.innerHTML === `o` && button_E.innerHTML === `o`)
          ||(button_G.innerHTML === `o` && button_I.innerHTML === `o`)))
          {
            return 'h';
          }
          else if(Pick[i]==='i'
          &&((button_C.innerHTML === `o` && button_F.innerHTML === `o`)
          ||(button_G.innerHTML === `o` && button_H.innerHTML === `o`)
          ||(button_A.innerHTML === `o` && button_E.innerHTML === `o`)))
          {
            return 'i';
          }
          else if(Pick[i]==='a'
          &&((button_D.innerHTML === `o` && button_G.innerHTML === `o`)
          ||(button_B.innerHTML === `o` && button_C.innerHTML === `o`)
          ||(button_E.innerHTML === `o` && button_I.innerHTML === `o`)))
          {
            return 'a';
          }
          else if(Pick[i]==='b'
          &&((button_E.innerHTML === `o` && button_H.innerHTML === `o`)
          ||(button_A.innerHTML === `o` && button_C.innerHTML === `o`)))
          {
            return 'b';
          }
          else if(Pick[i]==='c'
          &&((button_F.innerHTML === `o` && button_I.innerHTML === `o`)
          ||(button_A.innerHTML === `o` && button_B.innerHTML === `o`)
          ||(button_G.innerHTML === `o` && button_E.innerHTML === `o`)))
          {
            return 'c';
          }
          else if(Pick[i]==='f'
          &&((button_D.innerHTML === `o` && button_E.innerHTML === `o`)
          ||(button_C.innerHTML === `o` && button_I.innerHTML === `o`)))
          {
            return 'f';
          }
          else if(Pick[i]==='d'
          &&((button_E.innerHTML === `o` && button_F.innerHTML === `o`)
          ||(button_A.innerHTML === `o` && button_G.innerHTML === `o`)))
          {
            return 'd';
          }
          else if(Pick[i]==='e'
          &&((button_D.innerHTML === `o` && button_F.innerHTML === `o`)
          ||(button_B.innerHTML === `o` && button_H.innerHTML === `o`)
          ||(button_A.innerHTML === `o` && button_I.innerHTML === `o`)
          ||(button_C.innerHTML === `o` && button_G.innerHTML === `o`)))
          {
            return 'e';
          }
        }
          //second best
        for(let i=0;i<Pick.length;i++)
        {
          if(Pick[i]==='g'
          &&((button_A.innerHTML === `x` && button_D.innerHTML === `x`)
          ||(button_H.innerHTML === `x` && button_I.innerHTML === `x`)
          ||(button_E.innerHTML === `x` && button_C.innerHTML === `x`)))
          {
            return 'g';
          }
          else if(Pick[i]==='h'
          &&((button_B.innerHTML === `x` && button_E.innerHTML === `x`)
          ||(button_G.innerHTML === `x` && button_I.innerHTML === `x`)))
          {
            return 'h';
          }
          else if(Pick[i]==='i'
          &&((button_C.innerHTML === `x` && button_F.innerHTML === `x`)
          ||(button_G.innerHTML === `x` && button_H.innerHTML === `x`)
          ||(button_A.innerHTML === `x` && button_E.innerHTML === `x`)))
          {
            return 'i';
          }
          else if(Pick[i]==='a'
          &&((button_D.innerHTML === `x` && button_G.innerHTML === `x`)
          ||(button_B.innerHTML === `x` && button_C.innerHTML === `x`)
          ||(button_E.innerHTML === `x` && button_I.innerHTML === `x`)))
          {
            return 'a';
          }
          else if(Pick[i]==='b'
          &&((button_E.innerHTML === `x` && button_H.innerHTML === `x`)
          ||(button_A.innerHTML === `x` && button_C.innerHTML === `x`)))
          {
            return 'b';
          }
          else if(Pick[i]==='c'
          &&((button_F.innerHTML === `x` && button_I.innerHTML === `x`)
          ||(button_A.innerHTML === `x` && button_B.innerHTML === `x`)
          ||(button_G.innerHTML === `x` && button_E.innerHTML === `x`)))
          {
            return 'c';
          }
          else if(Pick[i]==='f'
          &&((button_D.innerHTML === `x` && button_E.innerHTML === `x`)
          ||(button_C.innerHTML === `x` && button_I.innerHTML === `x`)))
          {
            return 'f';
          }
          else if(Pick[i]==='d'
          &&((button_E.innerHTML === `x` && button_F.innerHTML === `x`)
          ||(button_A.innerHTML === `x` && button_G.innerHTML === `x`)))
          {
            return 'd';
          }
          else if(Pick[i]==='e'
          &&((button_D.innerHTML === `x` && button_F.innerHTML === `x`)
          ||(button_B.innerHTML === `x` && button_H.innerHTML === `x`)
          ||(button_A.innerHTML === `x` && button_I.innerHTML === `x`)
          ||(button_C.innerHTML === `x` && button_G.innerHTML === `x`)))
          {
            return 'e';
          }
        }
        let bestPick;
        if(mode===3)
        {
          bestPick=hardMode(Pick);
        }
        else
        {
          bestPick=easyMode(Pick);
        }
        return bestPick;
      }
      function hardMode(Pick)
      {
        let button_A = document.querySelector('.a');
        let button_B = document.querySelector('.b');
        let button_C = document.querySelector('.c');
        let button_D = document.querySelector('.d');
        let button_E = document.querySelector('.e');
        let button_F = document.querySelector('.f');
        let button_G = document.querySelector('.g');
        let button_H = document.querySelector('.h');
        let button_I = document.querySelector('.i');
        for(let j=0;j<Pick.length;j++)
        {
          //third best
          if(Pick[j]==='e'
          &&(button_A.innerHTML === `x`||button_B.innerHTML === `x`
          ||button_C.innerHTML === `x`||button_D.innerHTML === `x`
          ||button_F.innerHTML === `x`||button_G.innerHTML === `x`
          ||button_H.innerHTML === `x`||button_I.innerHTML === `x`))
          {
            return 'e';
          }
        }
        for(let j=0;j<Pick.length;j++)
        {
          if(Pick[j]==='a'
          &&(button_B.innerHTML === `x`||button_E.innerHTML === `x`
          ||button_D.innerHTML === `x`))
          {
            return 'a';
          }
          else if(Pick[j]==='b'
          &&(button_A.innerHTML === `x`||button_C.innerHTML === `x`
          ||button_D.innerHTML === `x`||button_E.innerHTML === `x`
          ||button_F.innerHTML === `x`))
          {
            return 'b';
          }
          else if(Pick[j]==='c'
          &&(button_B.innerHTML === `x`||button_E.innerHTML === `x`
          ||button_F.innerHTML === `x`))
          {
            return 'c';
          }
          else if(Pick[j]==='d'
          &&(button_A.innerHTML === `x`||button_B.innerHTML === `x`
          ||button_E.innerHTML === `x`||button_H.innerHTML === `x`
          ||button_G.innerHTML === `x`))
          {
            return 'd';
          }
          else if(Pick[j]==='f'
          &&(button_C.innerHTML === `x`||button_B.innerHTML === `x`
          ||button_E.innerHTML === `x`||button_H.innerHTML === `x`
          ||button_I.innerHTML === `x`))
          {
            return 'f';
          }
          else if(Pick[j]==='g'
          &&(button_D.innerHTML === `x`||button_E.innerHTML === `x`
          ||button_H.innerHTML === `x`))
          {
            return 'g';
          }
          else if(Pick[j]==='h'
          &&(button_G.innerHTML === `x`||button_D.innerHTML === `x`
          ||button_E.innerHTML === `x`||button_F.innerHTML === `x`
          ||button_I.innerHTML === `x`))
          {
            return 'h';
          }
          else if(Pick[j]==='i'
          &&(button_F.innerHTML === `x`||button_E.innerHTML === `x`
          ||button_H.innerHTML === `x`))
          {
            return 'i';
          }
          //fourth best
          else if(Pick[j]==='e'
          &&(button_A.innerHTML === `o`||button_B.innerHTML === `o`
          ||button_C.innerHTML === `o`||button_D.innerHTML === `o`
          ||button_F.innerHTML === `o`||button_G.innerHTML === `o`
          ||button_H.innerHTML === `o`||button_I.innerHTML === `o`))
          {
            return 'e';
          }
          else if(Pick[j]==='a'
          &&(button_B.innerHTML === `o`||button_E.innerHTML === `o`
          ||button_D.innerHTML === `o`))
          {
            return 'a';
          }
          else if(Pick[j]==='b'
          &&(button_A.innerHTML === `o`||button_C.innerHTML === `o`
          ||button_D.innerHTML === `o`||button_E.innerHTML === `o`
          ||button_F.innerHTML === `o`))
          {
            return 'b';
          }
          else if(Pick[j]==='c'
          &&(button_B.innerHTML === `o`||button_E.innerHTML === `o`
          ||button_F.innerHTML === `o`))
          {
            return 'c';
          }
          else if(Pick[j]==='d'
          &&(button_A.innerHTML === `o`||button_B.innerHTML === `o`
          ||button_E.innerHTML === `o`||button_H.innerHTML === `o`
          ||button_G.innerHTML === `o`))
          {
            return 'd';
          }
          else if(Pick[j]==='f'
          &&(button_C.innerHTML === `o`||button_B.innerHTML === `o`
          ||button_E.innerHTML === `o`||button_H.innerHTML === `o`
          ||button_I.innerHTML === `o`))
          {
            return 'f';
          }
          else if(Pick[j]==='g'
          &&(button_D.innerHTML === `o`||button_E.innerHTML === `o`
          ||button_H.innerHTML === `o`))
          {
            return 'g';
          }
          else if(Pick[j]==='h'
          &&(button_G.innerHTML === `o`||button_D.innerHTML === `o`
          ||button_E.innerHTML === `o`||button_F.innerHTML === `o`
          ||button_I.innerHTML === `o`))
          {
            return 'h';
          }
          else if(Pick[j]==='i'
          &&(button_F.innerHTML === `o`||button_E.innerHTML === `o`
          ||button_H.innerHTML === `o`))
          {
            return 'i';
          }
        }
        easyMode(Pick);
      }
    </script>
  </body>
</html>